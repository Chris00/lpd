<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lpd (lpd.Lpd)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">lpd</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Lpd</span></h1></header><p>LPD protocol server library (RFC 1179 compliant).</p><ul class="at-tag"><li><span class="at-tag author">Author</span>: Christophe Troestler</li><li><span class="at-tag version">Version</span>: 1.2.2</li></ul><h3>Types describing a print job</h3><div class="spec type" id="type-banner"><a href="#type-banner" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>banner</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-banner.user_name" class="anchored"><td class="def field"><a href="#type-banner.user_name" class="anchor"></a><code>user_name : string;</code></td><td class="doc"><p>(** User name for the banner page. *)</p></td></tr><tr id="type-banner.class_name" class="anchored"><td class="def field"><a href="#type-banner.class_name" class="anchor"></a><code>class_name : string;</code></td><td class="doc"><p>(** Class name, conventionally used to display the
host from which the printing job originated. *)</p></td></tr><tr id="type-banner.job_name" class="anchored"><td class="def field"><a href="#type-banner.job_name" class="anchor"></a><code>job_name : string;</code></td><td class="doc"><p>(** Job name, conventionally used to display the
name of the file or files which were &quot;printed&quot;. *)</p></td></tr></table><code>}</code><code></code></div><div class="doc"><p>Informations for a banner page.</p></div></div><div class="spec type" id="type-file_type"><a href="#type-file_type" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>file_type</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-file_type.Text" class="anchored"><td class="def constructor"><a href="#type-file_type.Text" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Text</span><span class="keyword"> of </span>int<span class="keyword"> * </span>int</code></td><td class="doc"><p>(** <code class="code">Text(indent, number_of_columns)</code>: print as a text file,
providing page breaks as necessary. According to the RFC,
any ASCII control chars other than '\b', '\t', '\n', '\012',
'\r' should be discarded -- it is your task to do so as you
know better how to deal with them (accented letters,...)
especially when you know PDF files may be sent using that type! *)</p></td></tr><tr id="type-file_type.Bin" class="anchored"><td class="def constructor"><a href="#type-file_type.Bin" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Bin</span></code></td><td class="doc"><p>(** Binary file to be printed as is (including control chars). *)</p></td></tr><tr id="type-file_type.PS" class="anchored"><td class="def constructor"><a href="#type-file_type.PS" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">PS</span></code></td><td class="doc"><p>(** PostScript file. *)</p></td></tr><tr id="type-file_type.DVI" class="anchored"><td class="def constructor"><a href="#type-file_type.DVI" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">DVI</span></code></td><td class="doc"><p>(** TeX DVI file. *)</p></td></tr><tr id="type-file_type.Troff" class="anchored"><td class="def constructor"><a href="#type-file_type.Troff" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Troff</span><span class="keyword"> of </span>string<span class="keyword"> * </span>string<span class="keyword"> * </span>string<span class="keyword"> * </span>string</code></td><td class="doc"><p>(** <code class="code">Troff(R font, I font, B font, S font)</code>: troff output file. *)</p></td></tr><tr id="type-file_type.Ditroff" class="anchored"><td class="def constructor"><a href="#type-file_type.Ditroff" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Ditroff</span></code></td><td class="doc"><p>(** ditroff (device independent troff) output. *)</p></td></tr><tr id="type-file_type.CIF" class="anchored"><td class="def constructor"><a href="#type-file_type.CIF" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">CIF</span></code></td><td class="doc"><p>(** CalTech Intermediate Form graphics language. *)</p></td></tr><tr id="type-file_type.Plot" class="anchored"><td class="def constructor"><a href="#type-file_type.Plot" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Plot</span></code></td><td class="doc"><p>(** Output from the Berkeley Unix plot library. *)</p></td></tr><tr id="type-file_type.Pr" class="anchored"><td class="def constructor"><a href="#type-file_type.Pr" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Pr</span><span class="keyword"> of </span>string<span class="keyword"> * </span>int</code></td><td class="doc"><p>(** <code class="code">Pr(title, number_of_columns)</code>: print with a heading, page
numbers, and pagination. The heading should include the
date and time that printing was started, the <code class="code">title</code>, and a
page number identifier followed by the page number. *)</p></td></tr><tr id="type-file_type.Fortran" class="anchored"><td class="def constructor"><a href="#type-file_type.Fortran" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Fortran</span></code></td><td class="doc"><p>(** Print interpreting the first column of each line as
FORTRAN carriage control. *)</p></td></tr><tr id="type-file_type.Raster" class="anchored"><td class="def constructor"><a href="#type-file_type.Raster" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Raster</span></code></td><td class="doc"><p>(** Sun raster format file. *)</p></td></tr></table><code></code></div><div class="doc"><p>Information on the type of the file to be printed.</p></div></div><div class="spec type" id="type-file"><a href="#type-file" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>file</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-file.name" class="anchored"><td class="def field"><a href="#type-file.name" class="anchor"></a><code>name : string;</code></td><td class="doc"><p>(** Name of the file on the client machine.
<code class="code">&quot;&quot;</code> means standard input. *)</p></td></tr><tr id="type-file.size" class="anchored"><td class="def field"><a href="#type-file.size" class="anchor"></a><code>size : int;</code></td><td class="doc"><p>(** Size in bytes of the file. *)</p></td></tr><tr id="type-file.nbcopies" class="anchored"><td class="def field"><a href="#type-file.nbcopies" class="anchor"></a><code>nbcopies : int;</code></td><td class="doc"><p>(** Number of copies requested. *)</p></td></tr><tr id="type-file.storage" class="anchored"><td class="def field"><a href="#type-file.storage" class="anchor"></a><code>storage : string;</code></td><td class="doc"><p>(** Local file on the disk holding the data. *)</p></td></tr><tr id="type-file.of_type" class="anchored"><td class="def field"><a href="#type-file.of_type" class="anchor"></a><code>of_type : <a href="index.html#type-file_type">file_type</a>;</code></td><td class="doc"><p>(** Type of the file. *)</p></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-job"><a href="#type-job" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>job</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-job.number" class="anchored"><td class="def field"><a href="#type-job.number" class="anchor"></a><code>number : int;</code></td><td class="doc"><p>(** Three digits job number. A negative number indicates that the
client did not send a correct job number. *)</p></td></tr><tr id="type-job.user" class="anchored"><td class="def field"><a href="#type-job.user" class="anchor"></a><code>user : string;</code></td><td class="doc"><p>(** User identification of the entity requesting the printing job. *)</p></td></tr><tr id="type-job.host" class="anchored"><td class="def field"><a href="#type-job.host" class="anchor"></a><code>host : string;</code></td><td class="doc"><p>(** Host which is to be treated as the source of the print job.
This is not necessarily the same as the machine which connected
this server -- the job may have been routed through several
computers. *)</p></td></tr><tr id="type-job.mailto" class="anchored"><td class="def field"><a href="#type-job.mailto" class="anchor"></a><code>mailto : string;</code></td><td class="doc"><p>(** If different from <code class="code">&quot;&quot;</code>, request that a mail be sent to the given
address when the printing operation ends (successfully or
unsuccessfully). There is no guarantee that the email address
is even well formed (e.g. it may only be the login name). *)</p></td></tr><tr id="type-job.banner" class="anchored"><td class="def field"><a href="#type-job.banner" class="anchor"></a><code>banner : <a href="index.html#type-banner">banner</a> option;</code></td><td class="doc"><p>(** Possible banner page. *)</p></td></tr><tr id="type-job.files" class="anchored"><td class="def field"><a href="#type-job.files" class="anchor"></a><code>files : <a href="index.html#type-file">file</a> list;</code></td><td class="doc"><p>(** List of files of this job. The files will be removed after the
job handling function <code class="code">on_reception</code> return. If you want to
keep them longer, rename them or (better) move them to another
directory. *)</p></td></tr><tr id="type-job.addr" class="anchored"><td class="def field"><a href="#type-job.addr" class="anchor"></a><code>addr : Unix.sockaddr;</code></td><td class="doc"><p>(** Address of the machine which connected to
this server. *)</p></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><h3>Module specifying the daemon behavior</h3><div class="spec type" id="type-jobref"><a href="#type-jobref" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>jobref</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-jobref.User" class="anchored"><td class="def constructor"><a href="#type-jobref.User" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">User</span><span class="keyword"> of </span>string</code></td><td class="doc"><p>(** Reference all jobs of the given user *)</p></td></tr><tr id="type-jobref.Num" class="anchored"><td class="def constructor"><a href="#type-jobref.Num" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Num</span><span class="keyword"> of </span>int</code></td><td class="doc"><p>(** Reference the job with the given number *)</p></td></tr></table><code></code></div><div class="doc"></div></div><div class="spec type" id="type-queue_actions"><a href="#type-queue_actions" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>queue_actions</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-queue_actions.print" class="anchored"><td class="def field"><a href="#type-queue_actions.print" class="anchor"></a><code>print : unit <span class="keyword">&#8209;&gt;</span> unit;</code></td><td class="doc"><p>(** Function executed when it is requested to start the printing
process (if not already running). *)</p></td></tr><tr id="type-queue_actions.on_reception" class="anchored"><td class="def field"><a href="#type-queue_actions.on_reception" class="anchor"></a><code>on_reception : <a href="index.html#type-job">job</a> <span class="keyword">&#8209;&gt;</span> unit;</code></td><td class="doc"><p>(** Handler for each job received. *)</p></td></tr><tr id="type-queue_actions.send_queue" class="anchored"><td class="def field"><a href="#type-queue_actions.send_queue" class="anchor"></a><code>send_queue : <a href="index.html#type-jobref">jobref</a> list <span class="keyword">&#8209;&gt;</span> <a href="../Socket/index.html#type-out_channel">Socket.out_channel</a> <span class="keyword">&#8209;&gt;</span> unit;</code></td><td class="doc"><p>(** Handler for sending a queue state in short form. *)</p></td></tr><tr id="type-queue_actions.send_queue_long" class="anchored"><td class="def field"><a href="#type-queue_actions.send_queue_long" class="anchor"></a><code>send_queue_long : <a href="index.html#type-jobref">jobref</a> list <span class="keyword">&#8209;&gt;</span> <a href="../Socket/index.html#type-out_channel">Socket.out_channel</a> <span class="keyword">&#8209;&gt;</span> unit;</code></td><td class="doc"><p>(** Handler for sending a queue state in long form. *)</p></td></tr><tr id="type-queue_actions.remove" class="anchored"><td class="def field"><a href="#type-queue_actions.remove" class="anchor"></a><code>remove : string <span class="keyword">&#8209;&gt;</span> Unix.sockaddr <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-jobref">jobref</a> list <span class="keyword">&#8209;&gt;</span> unit;</code></td><td class="doc"><p>(** Handler for removing jobs. The <code class="code">string</code> is the user name (the
agent) requesting the removal and <code class="code">Unix.sockaddr</code> is the address
of the machine which connected the server (to enable security
checks). <code class="code">lprm -</code>, requesting to remove all the jobs that the
user owns, gives as a list of jobs: <code class="code">[User &quot;-&quot;]</code>. *)</p></td></tr></table><code>}</code><code></code></div><div class="doc"><p>Functions to be executed on queue events.</p></div></div><div class="spec module-type" id="module-type-CONFIG"><a href="#module-type-CONFIG" class="anchor"></a><div class="def module-type"><code><span class="keyword">module type </span><a href="module-type-CONFIG/index.html">CONFIG</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Make"><a href="#module-Make" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Make/index.html">Make</a> : <span class="keyword">functor</span> (<a href="Make/argument-1-C/index.html">C</a> : <a href="index.html#module-type-CONFIG">CONFIG</a>) -&gt; <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>Make a Line Printer daemon according to the configuration <code class="code">C</code>.</p></div></div><h3>Useful functions</h3><div class="spec val" id="val-string_of_current_time"><a href="#val-string_of_current_time" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>string_of_current_time : unit <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">string_of_current_time()</code> returns the current date and time.</p></div></div><div class="spec val" id="val-header_of_job"><a href="#val-header_of_job" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>header_of_job : string <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">header_of_job queue</code> returns a string suitable as a header for
<a href="index.html#val-string_of_job">Lpd.string_of_job</a>. If <code class="code">queue = &quot;&quot;</code>, the mention of the queue
is omitted.</p></div></div><div class="spec val" id="val-string_of_job"><a href="#val-string_of_job" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>string_of_job : int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-job">job</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">string_of_job rank job</code> returns a one line string describing
the <code class="code">job</code>. A job with an empty list of files is considered to
have been canceled. The <code class="code">rank</code> is a positive number giving the
rank of the job in the queue. A <code class="code">rank</code> if <code class="code">0</code> means that the
job is in the printing stage. <code class="code">string_of_job</code> is a helper
function to design a <code class="code">send_queue</code> callback (see
<a href="index.html#type-queue_actions">Lpd.queue_actions</a>).</p></div></div><div class="spec val" id="val-long_string_of_job"><a href="#val-long_string_of_job" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>long_string_of_job : int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-job">job</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">long_string_of_job rank job</code> does the same as
<a href="index.html#val-string_of_job">Lpd.string_of_job</a> except that the description is in long
format (multi-lines). It is suitable to write <code class="code">send_queue_long</code>
callback (see <a href="index.html#type-queue_actions">Lpd.queue_actions</a>).</p></div></div><div class="spec val" id="val-any_host"><a href="#val-any_host" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>any_host : Unix.sockaddr <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">any_host addr</code> accepts any Internet host which can be found in
the DNS.</p></div></div><div class="spec val" id="val-these_hosts"><a href="#val-these_hosts" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>these_hosts : ?&#8288;file:string <span class="keyword">&#8209;&gt;</span> string list <span class="keyword">&#8209;&gt;</span> Unix.sockaddr <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">these_hosts ?file hosts adrr</code> accepts connections from Internet
hosts or IP addresses listed in the file or in the list <code class="code">hosts</code>.</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">file</span>: filename containing a list of hosts and IP addresses
to authorize separated with white space, tabulations, or
newlines. Blanks lines are ignored. Comments start with '#'
and last till the end of the line.</li></ul></div></div></body></html>